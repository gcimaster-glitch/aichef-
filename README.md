# Aメニュー（Aichefs.net）

## 📌 プロジェクト概要
**キャッチコピー**: 今日の献立、明日の笑顔。30日分の献立があなたの毎日を彩ります。

AIが家族構成に合わせて1ヶ月分の晩ごはん献立を自動生成する献立アプリです。

---

## 🌐 URL情報

### 本番環境
- **メインサイト**: https://aichefs.net
- **献立作成アプリ**: https://aichefs.net/app
- **管理画面**: https://aichefs.net/admin.html

### 開発環境
- https://aichef-595.pages.dev
- https://aichef-595.pages.dev/app
- https://aichef-595.pages.dev/admin.html

---

## ✅ 実装済み機能

### 1. 対話式献立作成
- 家族構成（大人・子供の人数と年齢）
- 予算設定（1人あたり300円〜1200円）
- 調理時間制限
- メニューバラエティ（定番中心／バランス／バラエティ重視）
- 監修者モード（栄養士／ママ／パパ／和食／洋食／中華など20種類）

### 2. **タイトルベース フィルタリング（暫定版）** ⭐ NEW
- **嫌いな食材の除外**
  - 対応: 貝類、エビ、タコ、イカ、カニ、内臓類、モツ、トマト、なす、ピーマン、セロリ、パクチー、きのこ、にんにく、玉ねぎ
  - 方式: レシピタイトルから日本語キーワードで検出
  - 例: 「エビフライ」→「エビ」を検出→除外
  
- **アレルギー対応**
  - 対応: 卵、乳、小麦、エビ、カニ、そば、ピーナッツ
  - 方式: レシピタイトルから日本語キーワードで検出
  - 例: 「親子丼」→「卵」を検出→除外

### 3. 献立カレンダー（30日分）
- 月表示のカレンダーUI
- 主菜・副菜・汁物の3品セット
- ドラッグ&ドロップで献立入れ替え
- レシピ詳細モーダル表示

### 4. レシピ詳細表示
- 調理時間、難易度、料理ジャンル
- 材料リスト（基本2人前）
- 調理手順
- タグ情報

### 5. 買い物リスト生成
- **人数分の数量計算対応** ⭐ 改善済み
- 週ごとの買い物リスト
- 月全体の買い物リスト
- カテゴリ別整理（野菜／肉・魚／卵・乳製品／豆腐・豆類／調味料）

### 6. インタラクティブUI
- **改善されたローディングアニメーション**
  - 3重回転リング（速度差あり）
  - 段階的プログレス表示（33% → 66% → 100%）
  - ステップアニメーション
  - プログレスバー
  - 豆知識表示

- **洗練された質問項目UI** ⭐ NEW
  - グラデーションボタン
  - ホバーエフェクト
  - アイコン表示
  - レスポンシブデザイン

### 7. レスポンシブフッター ⭐ 改善済み
- グラデーション背景（インディゴ→パープル→ピンク）
- 波のアニメーション
- 3カラムレイアウト（スマホ: 1カラム、タブレット: 2カラム、PC: 3カラム）
- ソーシャルアイコンのホバーエフェクト
- グラスモーフィズム
- 完全なレスポンシブ対応（テキスト折り返し、フォントサイズ調整、オーバーフロー防止）

---

## ⚠️ 暫定対応の制限事項

### タイトルベース フィルタリングの制限
1. **精度の限界**
   - レシピタイトルにキーワードが含まれていないと検出できない
   - 例: 「和風ハンバーグ」には「牛」「豚」が明示されていないため検出不可
   
2. **隠れた食材**
   - タイトルに明記されていない副材料は検出できない
   - 例: 「カレー」の中のエビは検出できない

3. **買い物リストの簡易性**
   - recipe_ingredientsデータ不足のため、正確な食材リストではなく推測ベース
   - 基本的な主要食材のみ表示

### 根本的な問題
**recipe_ingredientsテーブルのデータ不足**
- 現状: 703レシピ中47件（6.7%）のみデータあり
- 影響:
  1. 正確な食材フィルタリング不可
  2. 買い物リストの精度低下
  3. レシピ詳細の材料表示が不完全

---

## 🔧 技術スタック

- **フロントエンド**: HTML, TailwindCSS, JavaScript
- **バックエンド**: Hono (Cloudflare Workers)
- **データベース**: Cloudflare D1 (SQLite)
- **デプロイ**: Cloudflare Pages
- **Git**: GitHub

---

## 📊 データベース構成

### 主要テーブル
- **recipes**: 703件（主菜／副菜／汁物）
- **ingredients**: 154件
- **recipe_ingredients**: 47件 ⚠️ 不足
- **households**: 家族情報
- **meal_plans**: 献立プラン
- **meal_plan_days**: 日別献立
- **meal_plan_day_recipes**: 献立-レシピ関連

---

## 🚀 今後の改善計画

### Phase 1: データベース整備（最優先）
1. recipe_ingredientsデータの完全投入（1,492件生成済み）
   - Cloudflare D1の外部キー制約問題の解決
   - バッチ投入の最適化
   
2. フィルタリングの高精度化
   - 食材データベースベースのフィルタリングに移行
   - タイトルベースからの完全移行

### Phase 2: 機能拡充
1. 買い物リストの充実
   - 正確な食材データに基づく生成
   - 店舗別カテゴリ対応
   
2. レシピ詳細の改善
   - 完全な材料リスト表示
   - 代替食材の提案

### Phase 3: UX改善
1. お気に入り機能
2. 献立履歴
3. レシピ評価・コメント

---

## 📝 デプロイ状況

- **最新デプロイ**: 2026-01-05
- **デプロイURL**: https://ef653089.aichef-595.pages.dev
- **ステータス**: ✅ Active
- **最終更新内容**: タイトルベース フィルタリング実装

---

## 🎯 開発者向けメモ

### ローカル開発
```bash
# ビルド
npm run build

# 開発サーバー起動（PM2）
pm2 start ecosystem.config.cjs

# ログ確認
pm2 logs --nostream

# デプロイ
npm run deploy
```

### 主要コマンド
```bash
# データベースマイグレーション（ローカル）
npm run db:migrate:local

# データベースマイグレーション（本番）
npm run db:migrate:prod

# Git操作
npm run git:status
npm run git:commit "message"

# ポートクリーンアップ
npm run clean-port
```

---

## 📞 連絡先

- **プロジェクト管理者**: てつじ
- **GitHub**: プライベートリポジトリ
- **サポート**: https://aichefs.net のお問い合わせフォーム

---

**最終更新**: 2026-01-05  
**バージョン**: v2.1.0 (Title-based Filtering)
